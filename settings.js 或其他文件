// 修改之前的代码
chrome.storage.local.get(['isRotating', 'currentIndex', 'rotationInterval', 'lastRotationTime'], function(data) {
    // ...处理数据...
});

// 修改之后的代码 - 使用新的数据结构和错误处理
try {
  chrome.storage.local.get(['chartRotatorState'], function(result) {
    if (chrome.runtime.lastError) {
      console.error('存储访问错误:', chrome.runtime.lastError);
      return;
    }
    
    const state = result.chartRotatorState || defaultState;
    
    // 使用state替代旧的数据结构
    const isRotating = state.isRunning;
    const currentIndex = state.currentUrlIndex;
    const rotationInterval = state.interval;
    const lastRotationTime = state.lastRotationTime;
    
    // ...其余处理...
  });
} catch (error) {
  console.error('扩展上下文可能已失效:', error);
  // 可以在这里添加界面提示，比如显示错误信息或重新加载提示
} 